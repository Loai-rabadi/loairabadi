<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NASA Weather Insights - Ù†Ø¸Ø±Ø© Ù†Ø§Ø³Ø§ Ù„Ù„Ø·Ù‚Ø³</title>
    
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- AOS (Animate On Scroll) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Swiper CSS & JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    
    <!-- three.js for 3D effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        :root {
            --nasa-blue: #0b3d91;
            --nasa-red: #fc3d21;
            --nasa-dark: #0f172a;
            --nasa-light: #f8fafc;
            --jordan-red: #9e3030;
            --jordan-green: #2a5c2a;
            --jordan-black: #000;
            --jordan-white: #fff;
            --card-bg: rgba(255, 255, 255, 0.08);
            --gradient: linear-gradient(135deg, var(--nasa-blue), #1e40af);
            --gradient-red: linear-gradient(135deg, var(--nasa-red), #ff6b6b);
            --gradient-jordan: linear-gradient(135deg, var(--jordan-red), var(--jordan-green), var(--jordan-black));
            --border-radius: 16px;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Tajawal', 'Roboto', sans-serif;
            background: var(--nasa-dark);
            color: var(--nasa-light);
            line-height: 1.6;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 15% 50%, rgba(11, 61, 145, 0.2) 0%, transparent 25%),
                radial-gradient(circle at 85% 30%, rgba(252, 61, 33, 0.15) 0%, transparent 25%);
            perspective: 1000px;
        }
        
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxjaXJjbGUgY3g9IjUlIiBjeT0iMTUlIiByPSIxIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC4zIi8+PGNpcmNsZSBjeD0iMTUlIiBjeT0iNTAlIiByPSIwLjUiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjIiLz48Y2lyY2xlIGN4PSI3MCUiIGN5PSIzMCUiIHI9IjAuNyIgZmlsbD0id2hpdGUiIG9wYWNpdHk9IjAuNCIvPjxjaXJjbGUgY3g9IjkwJSIgY3k9IjgwJSIgcj0iMC4zIiBmaWxsPSJ3aGl0ZSIgb3BhY2l0eT0iMC41Ii8+PGNpcmNsZSBjeD0iNTAlIiBjeT0iODUlIiByPSIxLjIiIGZpbGw9IndoaXRlIiBvcGFjaXR5PSIwLjQiLz48L3N2Zz4=');
        }
        
        .jordan-flag {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 60px;
            height: 30px;
            background: linear-gradient(to bottom, var(--jordan-black) 33.3%, var(--jordan-white) 33.3%, var(--jordan-white) 66.6%, var(--jordan-green) 66.6%);
            border-radius: 4px;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 1000;
            overflow: hidden;
        }
        
        .jordan-flag::before {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 30px;
            height: 100%;
            background-color: var(--jordan-red);
        }
        
        .jordan-flag::after {
            content: "â˜…";
            position: absolute;
            top: 50%;
            right: 8px;
            transform: translateY(-50%);
            color: white;
            font-size: 10px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 40px 0;
            margin-bottom: 30px;
            position: relative;
            transform-style: preserve-3d;
        }
        
        .nasa-logo {
            font-size: 3.5rem;
            color: var(--nasa-red);
            margin-bottom: 20px;
            display: inline-block;
            background: var(--gradient-red);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            filter: drop-shadow(0 0 15px rgba(252, 61, 33, 0.5));
            animation: float 6s ease-in-out infinite, pulse 2s ease-in-out infinite alternate;
            transform: translateZ(20px);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--nasa-red), #ff9966, var(--jordan-red));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transform: translateZ(30px);
        }
        
        .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 25px;
            font-weight: 300;
            transform: translateZ(10px);
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 25px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 992px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }
        
        .control-panel {
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
            transition: var(--transition);
            transform-style: preserve-3d;
        }
        
        .control-panel:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4), 0 0 20px rgba(252, 61, 33, 0.3);
            transform: translateY(-5px) rotateX(2deg);
        }
        
        .control-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient-jordan);
            animation: gradientFlow 3s ease infinite;
            background-size: 200% 200%;
        }
        
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .map-container {
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            height: 550px;
            position: relative;
            overflow: hidden;
            transition: var(--transition);
            transform-style: preserve-3d;
        }
        
        .map-container:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4), 0 0 20px rgba(11, 61, 145, 0.3);
            transform: translateY(-5px) rotateX(2deg);
        }
        
        #map {
            width: 100%;
            height: 100%;
            border-radius: 12px;
            z-index: 1;
            transition: var(--transition);
        }
        
        #map:hover {
            transform: scale(1.01);
        }
        
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--nasa-light);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }
        
        label i {
            margin-left: 10px;
            color: var(--nasa-red);
            font-size: 1.2rem;
        }
        
        select, input, button {
            width: 100%;
            padding: 15px 20px;
            border-radius: 12px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
            color: var(--nasa-light);
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--nasa-red);
            box-shadow: 0 0 0 3px rgba(252, 61, 33, 0.3);
        }
        
        button {
            background: var(--gradient);
            color: white;
            border: none;
            font-weight: 600;
            cursor: pointer;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 16px 20px;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }
        
        button:hover::before {
            left: 100%;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(252, 61, 33, 0.4);
        }
        
        .results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
            transform-style: preserve-3d;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }
        
        .card:hover::before {
            transform: scaleX(1);
        }
        
        .card:hover {
            transform: translateY(-8px) rotateY(5deg);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .card-header i {
            font-size: 2rem;
            margin-right: 15px;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .card h3 {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--nasa-light);
        }
        
        .probability {
            font-size: 2.5rem;
            font-weight: 800;
            text-align: center;
            margin: 20px 0;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            display: inline-block;
        }
        
        .probability::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }
        
        .chart-container {
            background: var(--card-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            margin-bottom: 40px;
            position: relative;
            transition: var(--transition);
            transform-style: preserve-3d;
        }
        
        .chart-container:hover {
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
            transform: translateY(-5px) rotateX(2deg);
        }
        
        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: var(--gradient);
        }
        
        .data-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .secondary-btn {
            background: transparent;
            border: 2px solid var(--nasa-blue);
            color: var(--nasa-light);
        }
        
        .secondary-btn:hover {
            background: var(--nasa-blue);
        }
        
        footer {
            text-align: center;
            padding: 40px 0;
            margin-top: 60px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .jordan-text {
            color: var(--jordan-red);
            font-weight: bold;
            margin-top: 10px;
        }
        
        .data-source {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 15px;
        }
        
        /* Swiper Styles */
        .swiper {
            width: 100%;
            height: 100%;
            margin: 30px 0;
        }
        
        .swiper-slide {
            text-align: center;
            font-size: 18px;
            background: var(--card-bg);
            backdrop-filter: blur(12px);
            border-radius: var(--border-radius);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 30px;
            flex-direction: column;
            transition: var(--transition);
            transform-style: preserve-3d;
        }
        
        .swiper-slide:hover {
            transform: translateY(-5px) rotateY(5deg);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .swiper-pagination-bullet {
            background: var(--nasa-light);
            opacity: 0.5;
            width: 12px;
            height: 12px;
        }
        
        .swiper-pagination-bullet-active {
            background: var(--nasa-red);
            opacity: 1;
        }
        
        /* Animations */
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
            100% { transform: translateY(0px); }
        }
        
        /* Location Search Improvements */
        .location-search-container {
            position: relative;
        }
        
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.95);
            border-radius: 0 0 12px 12px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-top: none;
        }
        
        .search-suggestions div {
            padding: 12px 20px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .search-suggestions div:hover {
            background: rgba(252, 61, 33, 0.2);
        }
        
        /* Responsive Adjustments */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .subtitle {
                font-size: 1.1rem;
            }
            
            .dashboard {
                gap: 20px;
            }
            
            .control-panel, .map-container {
                padding: 20px;
            }
            
            .data-actions {
                flex-direction: column;
            }
            
            .probability {
                font-size: 2rem;
            }
            
            .jordan-flag {
                width: 50px;
                height: 25px;
                top: 15px;
                left: 15px;
            }
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--nasa-blue);
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--nasa-red);
        }
        
        /* Loading Animation */
        .loader {
            display: inline-block;
            width: 80px;
            height: 80px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
        }
        
        .loader:after {
            content: " ";
            display: block;
            width: 64px;
            height: 64px;
            margin: 8px;
            border-radius: 50%;
            border: 6px solid var(--nasa-red);
            border-color: var(--nasa-red) transparent var(--nasa-red) transparent;
            animation: loader 1.2s linear infinite;
        }
        
        @keyframes loader {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Map Location Picker */
        .location-picker-tooltip {
            position: absolute;
            background: rgba(15, 23, 42, 0.9);
            padding: 10px 15px;
            border-radius: 8px;
            z-index: 1000;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: pulse 2s infinite;
            display: none;
        }
        
        /* Coordinates Input */
        .coordinates-input {
            display: none;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Weather Icons */
        .weather-icon {
            font-size: 2.5rem;
            margin: 15px 0;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

        /* 3D Earth Globe */
        #earth-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 150px;
            height: 150px;
            z-index: 999;
            cursor: pointer;
            transition: all 0.5s ease;
        }

        #earth-container:hover {
            transform: scale(1.1);
        }

        /* Satellite 3D Animation */
        .satellite {
            position: absolute;
            width: 20px;
            height: 20px;
            background: var(--nasa-red);
            border-radius: 50%;
            box-shadow: 0 0 10px var(--nasa-red), 0 0 20px var(--nasa-red);
            animation: orbit 10s linear infinite;
            transform-style: preserve-3d;
        }

        @keyframes orbit {
            0% {
                transform: rotate(0deg) translateX(70px) rotate(0deg);
            }
            100% {
                transform: rotate(360deg) translateX(70px) rotate(-360deg);
            }
        }

        /* 3D Card Flip */
        .card-3d {
            transform-style: preserve-3d;
            transition: transform 0.8s;
        }

        .card-3d:hover {
            transform: rotateY(15deg) rotateX(5deg);
        }

        /* Parallax Scrolling Effect */
        .parallax {
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: cover;
        }
    </style>
</head>
<body>
    <div class="stars"></div>
    <div class="jordan-flag" title="ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± ÙÙŠ Ø§Ù„Ø£Ø±Ø¯Ù†"></div>
    
    <!-- 3D Earth Container -->
    <div id="earth-container"></div>
    
    <div class="container">
        <header data-aos="fade-down" data-aos-duration="1000">
            <div class="nasa-logo">
                <i class="fas fa-planet-ringed"></i>
            </div>
            <h1 class="animate__animated animate__fadeIn">Ù†Ø¸Ø§Ù… Ù†Ø§Ø³Ø§ Ù„Ù„Ø·Ù‚Ø³ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ</h1>
            <p class="subtitle animate__animated animate__fadeIn animate__delay-1s">
                Ø§Ø³ØªÙƒØ´Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© Ù…Ù† Ù†Ø§Ø³Ø§ ÙˆØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª Ù„Ø£ÙŠ Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…. 
                Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù„ØªØ­Ø¶ÙŠØ± Ù„Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†Ø§Ø®ÙŠØ© Ù…ÙˆØ«ÙˆÙ‚Ø©.
            </p>
        </header>
        
        <div class="dashboard">
            <div class="control-panel" data-aos="fade-right" data-aos-duration="1000">
                <div class="form-group">
                    <label for="location-type"><i class="fas fa-map-marker-alt"></i> Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
                    <select id="location-type">
                        <option value="search">Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…</option>
                        <option value="map">ØªØ­Ø¯ÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</option>
                        <option value="coordinates">Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</option>
                    </select>
                </div>
                
                <div class="form-group" id="search-group">
                    <div class="location-search-container">
                        <label for="location-search"><i class="fas fa-search"></i> Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹</label>
                        <input type="text" id="location-search" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">
                        <div class="search-suggestions" id="search-suggestions"></div>
                    </div>
                </div>
                
                <div class="form-group coordinates-input" id="coordinates-group">
                    <div>
                        <label for="latitude"><i class="fas fa-globe"></i> Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶</label>
                        <input type="text" id="latitude" placeholder="Ù…Ø«Ø§Ù„: 31.95">
                    </div>
                    <div>
                        <label for="longitude"><i class="fas fa-globe"></i> Ø®Ø· Ø§Ù„Ø·ÙˆÙ„</label>
                        <input type="text" id="longitude" placeholder="Ù…Ø«Ø§Ù„: 35.93">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="date-selection"><i class="fas fa-calendar-alt"></i> Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="date-selection">
                </div>
                
                <div class="form-group">
                    <label for="weather-variables"><i class="fas fa-sliders-h"></i> Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø·Ù‚Ø³</label>
                    <select id="weather-variables" multiple>
                        <option value="temperature">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</option>
                        <option value="precipitation">Ù‡Ø·ÙˆÙ„ Ø§Ù„Ø£Ù…Ø·Ø§Ø±</option>
                        <option value="wind">Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­</option>
                        <option value="humidity">Ø§Ù„Ø±Ø·ÙˆØ¨Ø©</option>
                        <option value="snow">ØªØ³Ø§Ù‚Ø· Ø§Ù„Ø«Ù„ÙˆØ¬</option>
                        <option value="cloud">Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ</option>
                        <option value="pressure">Ø§Ù„Ø¶ØºØ· Ø§Ù„Ø¬ÙˆÙŠ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="threshold"><i class="fas fa-chart-line"></i> Ø¹ØªØ¨Ø© Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ (%)</label>
                    <input type="range" id="threshold" min="0" max="100" value="60">
                    <output for="threshold" id="threshold-value">60%</output>
                </div>
                
                <button id="analyze-btn">
                    <i class="fas fa-satellite"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>
            
            <div class="map-container" data-aos="fade-left" data-aos-duration="1000">
                <div id="map"></div>
                <div class="location-picker-tooltip" id="location-picker-tooltip">
                    <i class="fas fa-mouse-pointer"></i> Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹
                </div>
            </div>
        </div>
        
        <!-- Swiper Slider for Results -->
        <div class="swiper mySwiper" data-aos="fade-up" data-aos-duration="1000">
            <div class="swiper-wrapper">
                <div class="swiper-slide card-3d">
                    <div class="card-header">
                        <i class="fas fa-temperature-high"></i>
                        <h3>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</h3>
                    </div>
                    <div class="weather-icon">ğŸŒ¡ï¸</div>
                    <div class="probability">72%</div>
                    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© ØªØ¬Ø§ÙˆØ² 30Â°C ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©.</p>
                </div>
                <div class="swiper-slide card-3d">
                    <div class="card-header">
                        <i class="fas fa-cloud-rain"></i>
                        <h3>Ù‡Ø·ÙˆÙ„ Ø§Ù„Ø£Ù…Ø·Ø§Ø±</h3>
                    </div>
                    <div class="weather-icon">ğŸŒ§ï¸</div>
                    <div class="probability">45%</div>
                    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ù‡Ø·ÙˆÙ„ Ø£Ù…Ø·Ø§Ø± ØªØ²ÙŠØ¯ Ø¹Ù† 5mm ÙÙŠ 24 Ø³Ø§Ø¹Ø©.</p>
                </div>
                <div class="swiper-slide card-3d">
                    <div class="card-header">
                        <i class="fas fa-wind"></i>
                        <h3>Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­</h3>
                    </div>
                    <div class="weather-icon">ğŸ’¨</div>
                    <div class="probability">28%</div>
                    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© ØªØ¬Ø§ÙˆØ² Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­ 20km/h Ø®Ù„Ø§Ù„ Ø§Ù„Ù†Ù‡Ø§Ø±.</p>
                </div>
            </div>
            <div class="swiper-pagination"></div>
        </div>
        
        <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
            <h2><i class="fas fa-chart-area"></i> Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠ Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±Ø©</h2>
            <canvas id="weather-chart"></canvas>
            
            <div class="data-actions">
                <button id="download-csv">
                    <i class="fas fa-file-csv"></i> ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (CSV)
                </button>
                <button class="secondary-btn" id="download-json">
                    <i class="fas fa-file-code"></i> ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (JSON)
                </button>
            </div>
        </div>
        
        <footer data-aos="fade-up" data-aos-duration="1000">
            <p>ØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ø³Ø§ Ù„Ù„Ø·Ù‚Ø³ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ</p>
            <p class="jordan-text">ğŸ‡¯ğŸ‡´ ØªØ·ÙˆÙŠØ± Ø£Ø±Ø¯Ù†ÙŠ Ø¨Ø¥ØªÙ‚Ø§Ù† ğŸ‡¯ğŸ‡´</p>
            <p class="data-source">Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø±Ø¶ Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù†Ø§Ø³Ø§ (EOSDIS)</p>
        </footer>
    </div>

    <script>
        // Initialize AOS (Animate On Scroll)
        AOS.init({
            duration: 1000,
            once: true,
            offset: 100
        });
        
        // Initialize Swiper
        const swiper = new Swiper(".mySwiper", {
            effect: "coverflow",
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: "auto",
            coverflowEffect: {
                rotate: 20,
                stretch: 0,
                depth: 200,
                modifier: 1,
                slideShadows: true,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true
            },
            breakpoints: {
                640: {
                    slidesPerView: 1,
                    spaceBetween: 20,
                },
                768: {
                    slidesPerView: 2,
                    spaceBetween: 30,
                },
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 40,
                },
            }
        });
        
        // Initialize Map
        const map = L.map('map').setView([31.95, 35.93], 7);
        
        // Add Map Layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // Add Draggable Marker
        const marker = L.marker([31.95, 35.93], {draggable: true}).addTo(map);
        marker.bindPopup('Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø­Ø¯Ø¯').openPopup();
        
        // Update marker position on drag
        marker.on('dragend', function() {
            const position = marker.getLatLng();
            updateCoordinates(position.lat, position.lng);
            reverseGeocode(position.lat, position.lng);
        });
        
        // Function to update coordinates inputs
        function updateCoordinates(lat, lng) {
            document.getElementById('latitude').value = lat.toFixed(6);
            document.getElementById('longitude').value = lng.toFixed(6);
        }
        
        // Function to reverse geocode coordinates to address
        function reverseGeocode(lat, lng) {
            // Using Nominatim for reverse geocoding
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`)
                .then(response => response.json())
                .then(data => {
                    if (data && data.display_name) {
                        document.getElementById('location-search').value = data.display_name;
                    }
                })
                .catch(error => console.error('Error in reverse geocoding:', error));
        }
        
        // Function to geocode address to coordinates
        function geocodeAddress(address) {
            if (!address) return;
            
            // Using Nominatim for geocoding
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`)
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        const lat = parseFloat(data[0].lat);
                        const lon = parseFloat(data[
                            <!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NASA Weather Insights - Ù†Ø¸Ø±Ø© Ù†Ø§Ø³Ø§ Ù„Ù„Ø·Ù‚Ø³</title>
    
    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Animate.css -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    
    <!-- AOS (Animate On Scroll) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Swiper CSS & JS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    
    <!-- three.js for 3D effects -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <style>
        /* Ø£Ù†Ù…Ø§Ø· CSS Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ù‡Ù†Ø§ */
    </style>
</head>
<body>
    <div class="stars"></div>
    <div class="jordan-flag" title="ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± ÙÙŠ Ø§Ù„Ø£Ø±Ø¯Ù†"></div>
    
    <!-- 3D Earth Container -->
    <div id="earth-container"></div>
    
    <div class="container">
        <header data-aos="fade-down" data-aos-duration="1000">
            <div class="nasa-logo">
                <i class="fas fa-planet-ringed"></i>
            </div>
            <h1 class="animate__animated animate__fadeIn">Ù†Ø¸Ø§Ù… Ù†Ø§Ø³Ø§ Ù„Ù„Ø·Ù‚Ø³ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ</h1>
            <p class="subtitle animate__animated animate__fadeIn animate__delay-1s">
                Ø§Ø³ØªÙƒØ´Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù‚Ø³ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ© Ù…Ù† Ù†Ø§Ø³Ø§ ÙˆØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„Ø§Øª Ù„Ø£ÙŠ Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…. 
                Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ù„Ù„ØªØ­Ø¶ÙŠØ± Ù„Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù†Ø§Ø®ÙŠØ© Ù…ÙˆØ«ÙˆÙ‚Ø©.
            </p>
        </header>
        
        <div class="dashboard">
            <div class="control-panel" data-aos="fade-right" data-aos-duration="1000">
                <div class="form-group">
                    <label for="location-type"><i class="fas fa-map-marker-alt"></i> Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
                    <select id="location-type">
                        <option value="search">Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù…</option>
                        <option value="map">ØªØ­Ø¯ÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©</option>
                        <option value="coordinates">Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª</option>
                    </select>
                </div>
                
                <div class="form-group" id="search-group">
                    <div class="location-search-container">
                        <label for="location-search"><i class="fas fa-search"></i> Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…ÙˆÙ‚Ø¹</label>
                        <input type="text" id="location-search" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£Ùˆ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©">
                        <div class="search-suggestions" id="search-suggestions"></div>
                    </div>
                </div>
                
                <div class="form-group coordinates-input" id="coordinates-group">
                    <div>
                        <label for="latitude"><i class="fas fa-globe"></i> Ø®Ø· Ø§Ù„Ø¹Ø±Ø¶</label>
                        <input type="text" id="latitude" placeholder="Ù…Ø«Ø§Ù„: 31.95">
                    </div>
                    <div>
                        <label for="longitude"><i class="fas fa-globe"></i> Ø®Ø· Ø§Ù„Ø·ÙˆÙ„</label>
                        <input type="text" id="longitude" placeholder="Ù…Ø«Ø§Ù„: 35.93">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="date-selection"><i class="fas fa-calendar-alt"></i> Ø§Ù„ØªØ§Ø±ÙŠØ®</label>
                    <input type="date" id="date-selection">
                </div>
                
                <div class="form-group">
                    <label for="weather-variables"><i class="fas fa-sliders-h"></i> Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø·Ù‚Ø³</label>
                    <select id="weather-variables" multiple>
                        <option value="temperature">Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</option>
                        <option value="precipitation">Ù‡Ø·ÙˆÙ„ Ø§Ù„Ø£Ù…Ø·Ø§Ø±</option>
                        <option value="wind">Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­</option>
                        <option value="humidity">Ø§Ù„Ø±Ø·ÙˆØ¨Ø©</option>
                        <option value="snow">ØªØ³Ø§Ù‚Ø· Ø§Ù„Ø«Ù„ÙˆØ¬</option>
                        <option value="cloud">Ø§Ù„ØºØ·Ø§Ø¡ Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠ</option>
                        <option value="pressure">Ø§Ù„Ø¶ØºØ· Ø§Ù„Ø¬ÙˆÙŠ</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="threshold"><i class="fas fa-chart-line"></i> Ø¹ØªØ¨Ø© Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ (%)</label>
                    <input type="range" id="threshold" min="0" max="100" value="60">
                    <output for="threshold" id="threshold-value">60%</output>
                </div>
                
                <button id="analyze-btn">
                    <i class="fas fa-satellite"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                </button>
            </div>
            
            <div class="map-container" data-aos="fade-left" data-aos-duration="1000">
                <div id="map"></div>
                <div class="location-picker-tooltip" id="location-picker-tooltip">
                    <i class="fas fa-mouse-pointer"></i> Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹
                </div>
            </div>
        </div>
        
        <!-- Swiper Slider for Results -->
        <div class="swiper mySwiper" data-aos="fade-up" data-aos-duration="1000">
            <div class="swiper-wrapper">
                <div class="swiper-slide card-3d">
                    <div class="card-header">
                        <i class="fas fa-temperature-high"></i>
                        <h3>Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©</h3>
                    </div>
                    <div class="weather-icon">ğŸŒ¡ï¸</div>
                    <div class="probability">72%</div>
                    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© ØªØ¬Ø§ÙˆØ² 30Â°C ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠØ©.</p>
                </div>
                <div class="swiper-slide card-3d">
                    <div class="card-header">
                        <i class="fas fa-cloud-rain"></i>
                        <h3>Ù‡Ø·ÙˆÙ„ Ø§Ù„Ø£Ù…Ø·Ø§Ø±</h3>
                    </div>
                    <div class="weather-icon">ğŸŒ§ï¸</div>
                    <div class="probability">45%</div>
                    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© Ù‡Ø·ÙˆÙ„ Ø£Ù…Ø·Ø§Ø± ØªØ²ÙŠØ¯ Ø¹Ù† 5mm ÙÙŠ 24 Ø³Ø§Ø¹Ø©.</p>
                </div>
                <div class="swiper-slide card-3d">
                    <div class="card-header">
                        <i class="fas fa-wind"></i>
                        <h3>Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­</h3>
                    </div>
                    <div class="weather-icon">ğŸ’¨</div>
                    <div class="probability">28%</div>
                    <p>Ø§Ø­ØªÙ…Ø§Ù„ÙŠØ© ØªØ¬Ø§ÙˆØ² Ø³Ø±Ø¹Ø© Ø§Ù„Ø±ÙŠØ§Ø­ 20km/h Ø®Ù„Ø§Ù„ Ø§Ù„Ù†Ù‡Ø§Ø±.</p>
                </div>
            </div>
            <div class="swiper-pagination"></div>
        </div>
        
        <div class="chart-container" data-aos="fade-up" data-aos-duration="1000">
            <h2><i class="fas fa-chart-area"></i> Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø§Ø­ØªÙ…Ø§Ù„ÙŠ Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±Ø©</h2>
            <canvas id="weather-chart"></canvas>
            
            <div class="data-actions">
                <button id="download-csv">
                    <i class="fas fa-file-csv"></i> ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (CSV)
                </button>
                <button class="secondary-btn" id="download-json">
                    <i class="fas fa-file-code"></i> ØªÙ†Ø²ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (JSON)
                </button>
            </div>
        </div>
        
        <footer data-aos="fade-up" data-aos-duration="1000">
            <p>ØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ø§ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ø³Ø§ Ù„Ù„Ø·Ù‚Ø³ Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ</p>
            <p class="jordan-text">ğŸ‡¯ğŸ‡´ ØªØ·ÙˆÙŠØ± Ø£Ø±Ø¯Ù†ÙŠ Ø¨Ø¥ØªÙ‚Ø§Ù† ğŸ‡¯ğŸ‡´</p>
            <p class="data-source">Ù…ØµØ¯Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø£Ø±Ø¶ Ø§Ù„ØªØ§Ø¨Ø¹ Ù„Ù†Ø§Ø³Ø§ (EOSDIS)</p>
        </footer>
    </div>

    <script>
        // Initialize AOS (Animate On Scroll)
        AOS.init({
            duration: 1000,
            once: true,
            offset: 100
        });
        
        // Initialize Swiper
        const swiper = new Swiper(".mySwiper", {
            effect: "coverflow",
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: "auto",
            coverflowEffect: {
                rotate: 20,
                stretch: 0,
                depth: 200,
                modifier: 1,
                slideShadows: true,
            },
            pagination: {
                el: ".swiper-pagination",
                clickable: true
            },
            breakpoints: {
                640: {
                    slidesPerView: 1,
                    spaceBetween: 20,
                },
                768: {
                    slidesPerView: 2,
                    spaceBetween: 30,
                },
                1024: {
                    slidesPerView: 3,
                    spaceBetween: 40,
                },
            }
        });
        
        // Initialize Map
        const map = L.map('map').setView([31.95, 35.93], 7);
        
        // Add Map Layer
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        
        // Add Draggable Marker
        const marker = L.marker([31.95, 35.93], {draggable: true}).addTo(map);
        marker.bindPopup('Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø­Ø¯Ø¯').openPopup();
        
        // Update marker position on drag
        marker.on('dragend', function() {
            const position = marker.getLatLng();
            updateCoordinates(position.lat, position.lng);
            reverseGeocode(position.lat, position.lng);
        });
        
        // Function to update coordinates inputs
        function updateCoordinates(lat, lng) {
            document.getElementById('latitude').value = lat.toFixed(6);
            document.getElementById('longitude').value = lng.toFixed(6);
        }
        
        // Function to reverse geocode coordinates to address
        function reverseGeocode(lat, lng) {
            // Using Nominatim for reverse geocoding
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`)
                .then(response => response.json())
                .then(data => {
                    if (data && data.display_name) {
                        document.getElementById('location-search').value = data.display_name;
                    }
                })
                .catch(error => console.error('Error in reverse geocoding:', error));
        }
        
        // Function to geocode address to coordinates
        function geocodeAddress(address) {
            if (!address) return;
            
            // Using Nominatim for geocoding
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address)}`)
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        const lat = parseFloat(data[0].lat);
                        const lon = parseFloat(data[0].lon);
                        
                        // Update map and marker
                        map.setView([lat, lon], 10);
                        marker.setLatLng([lat, lon]);
                        
                        // Update coordinates inputs
                        updateCoordinates(lat, lon);
                    }
                })
                .catch(error => console.error('Error in geocoding:', error));
        }
        
        // Handle location type change
        document.getElementById('location-type').addEventListener('change', function() {
            const type = this.value;
            const searchGroup = document.getElementById('search-group');
            const coordinatesGroup = document.getElementById('coordinates-group');
            const locationPickerTooltip = document.getElementById('location-picker-tooltip');
            
            // Reset all
            searchGroup.style.display = 'block';
            coordinatesGroup.style.display = 'none';
            locationPickerTooltip.style.display = 'none';
            
            if (type === 'coordinates') {
                searchGroup.style.display = 'none';
                coordinatesGroup.style.display = 'grid';
            } else if (type === 'map') {
                locationPickerTooltip.style.display = 'block';
            }
        });
        
        // Handle map click for location selection
        map.on('click', function(e) {
            if (document.getElementById('location-type').value === 'map') {
                const lat = e.latlng.lat;
                const lng = e.latlng.lng;
                
                // Update marker position
                marker.setLatLng([lat, lng]);
                
                // Update coordinates inputs
                updateCoordinates(lat, lng);
                
                // Reverse geocode to get address
                reverseGeocode(lat, lng);
            }
        });
        
        // Handle location search input
        let searchTimeout;
        document.getElementById('location-search').addEventListener('input', function() {
            clearTimeout(searchTimeout);
            const query = this.value.trim();
            
            if (query.length < 3) {
                document.getElementById('search-suggestions').style.display = 'none';
                return;
            }
            
            searchTimeout = setTimeout(() => {
                // Using Nominatim for search suggestions
                fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(query)}&limit=5`)
                    .then(response => response.json())
                    .then(data => {
                        const suggestionsContainer = document.getElementById('search-suggestions');
                        suggestionsContainer.innerHTML = '';
                        
                        if (data && data.length > 0) {
                            data.forEach(place => {
                                const div = document.createElement('div');
                                div.textContent = place.display_name;
                                div.addEventListener('click', () => {
                                    document.getElementById('location-search').value = place.display_name;
                                    suggestionsContainer.style.display = 'none';
                                    
                                    // Update map and marker
                                    const lat = parseFloat(place.lat);
                                    const lon = parseFloat(place.lon);
                                    map.setView([lat, lon], 10);
                                    marker.setLatLng([lat, lon]);
                                    
                                    // Update coordinates inputs
                                    updateCoordinates(lat, lon);
                                });
                                suggestionsContainer.appendChild(div);
                            });
                            
                            suggestionsContainer.style.display = 'block';
                        }
                    })
                    .catch(error => console.error('Error fetching search suggestions:', error));
            }, 500);
        });
        
        // Hide suggestions when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.location-search-container')) {
                document.getElementById('search-suggestions').style.display = 'none';
            }
        });
        
        // Update threshold value display
        document.getElementById('threshold').addEventListener('input', function() {
            document.getElementById('threshold-value').textContent = this.value + '%';
        });
        
        // Initialize weather chart
        const ctx = document.getElementById('weather-chart').getContext('2d');
        const weatherChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ', 'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'],
                datasets: [{
                    label: 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© (Â°C)',
                    data: [12, 14, 18, 23, 28, 32, 34, 34, 30, 25, 19, 14],
                    borderColor: '#fc3d21',
                    backgroundColor: 'rgba(252, 61, 33, 0.1)',
                    borderWidth: 2,
                    tension: 0.3,
                    fill: true
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    title: {
                        display: true,
                        text: 'Ù…ØªÙˆØ³Ø· Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ø­Ø±Ø§Ø±Ø© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©',
                        font: {
                            size: 16,
                            family: 'Tajawal'
                        }
                    },
                    legend: {
                        position: 'top',
                        rtl: true,
                        labels: {
                            font: {
                                family: 'Tajawal'
                            }
                        }
                    },
                    tooltip: {
                        rtl: true,
                        titleFont: {
                            family: 'Tajawal'
                        },
                        bodyFont: {
                            family: 'Tajawal'
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø© (Â°C)',
                            font: {
                                family: 'Tajawal'
                            }
                        },
                        ticks: {
                            font: {
                                family: 'Tajawal'
                            }
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Ø§Ù„Ø´Ù‡Ø±',
                            font: {
                                family: 'Tajawal'
                            }
                        },
                        ticks: {
                            font: {
                                family: 'Tajawal'
                            }
                        }
                    }
                }
            }
        });
        
        // Handle analyze button click
        document.getElementById('analyze-btn').addEventListener('click', function() {
            // Show loading state
            this.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„...';
            this.disabled = true;
            
            // Simulate API call
            setTimeout(() => {
                // Update results with mock data
                const probabilities = [72, 45, 28];
                document.querySelectorAll('.probability').forEach((el, index) => {
                    el.textContent = probabilities[index] + '%';
                });
                
                // Update chart with new data
                const newData = Array.from({length: 12}, () => Math.floor(Math.random() * 25) + 10);
                weatherChart.data.datasets[0].data = newData;
                weatherChart.update();
                
                // Reset button
                this.innerHTML = '<i class="fas fa-satellite"></i> ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                this.disabled = false;
                
                // Show success notification
                showNotification('ØªÙ… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }, 2000);
        });
        
        // Handle download buttons
        document.getElementById('download-csv').addEventListener('click', function() {
            // Simulate CSV download
            const csvContent = "data:text/csv;charset=utf-8,"
                + "Ø§Ù„Ø´Ù‡Ø±,Ø¯Ø±Ø¬Ø© Ø§Ù„Ø­Ø±Ø§Ø±Ø©\n"
                + weatherChart.data.labels.map((month, i) => `${month},${weatherChart.data.datasets[0].data[i]}`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "Ù†Ø§Ø³Ø§_Ø¨ÙŠØ§Ù†Ø§Øª_Ø§Ù„Ø·Ù‚Ø³.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù CSV Ø¨Ù†Ø¬Ø§Ø­', 'success');
        });
        
        document.getElementById('download-json').addEventListener('click', function() {
            // Simulate JSON download
            const jsonData = {
                location: document.getElementById('location-search').value || "Ù…ÙˆÙ‚Ø¹ ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
                date: document.getElementById('date-selection').value || new Date().toISOString().split('T')[0],
                temperatureData: weatherChart.data.labels.map((month, i) => ({
                    month,
                    temperature: weatherChart.data.datasets[0].data[i]
                }))
            };
            
            const jsonContent = "data:text/json;charset=utf-8," + JSON.stringify(jsonData, null, 2);
            const encodedUri = encodeURI(jsonContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "Ù†Ø§Ø³Ø§_Ø¨ÙŠØ§Ù†Ø§Øª_Ø§Ù„Ø·Ù‚Ø³.json");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ØªÙ… ØªÙ†Ø²ÙŠÙ„ Ù…Ù„Ù JSON Ø¨Ù†Ø¬Ø§Ø­', 'success');
        });
        
        // Initialize 3D Earth
        function initEarth() {
            const container = document.getElementById('earth-container');
            const width = container.clientWidth;
            const height = container.clientHeight;
            
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(width, height);
            container.appendChild(renderer.domElement);
            
            // Create Earth
            const geometry = new THREE.SphereGeometry(0.5, 32, 32);
            const texture = new THREE.TextureLoader().load('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-blue-marble.jpg');
            const material = new THREE.MeshPhongMaterial({ map: texture });
            const earth = new THREE.Mesh(geometry, material);
            scene.add(earth);
            
            // Add clouds
            const cloudGeometry = new THREE.SphereGeometry(0.52, 32, 32);
            const cloudTexture = new THREE.TextureLoader().load('https://cdn.jsdelivr.net/npm/three-globe/example/img/earth-clouds.png');
            const cloudMaterial = new THREE.MeshPhongMaterial({
                map: cloudTexture,
                transparent: true,
                opacity: 0.4
            });
            const clouds = new THREE.Mesh(cloudGeometry, cloudMaterial);
            scene.add(clouds);
            
            // Add lights
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 3, 5);
            scene.add(directionalLight);
            
            camera.position.z = 1.8;
            
            // Add stars background
            const starGeometry = new THREE.BufferGeometry();
            const starMaterial = new THREE.PointsMaterial({
                color: 0xffffff,
                size: 0.02
            });
            
            const starVertices = [];
            for (let i = 0; i < 1000; i++) {
                const x = (Math.random() - 0.5) * 10;
                const y = (Math.random() - 0.5) * 10;
                const z = (Math.random() - 0.5) * 10;
                starVertices.push(x, y, z);
            }
            
            starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
            const stars = new THREE.Points(starGeometry, starMaterial);
            scene.add(stars);
            
            // Animation
            function animate() {
                requestAnimationFrame(animate);
                
                earth.rotation.y += 0.001;
                clouds.rotation.y += 0.0015;
                stars.rotation.y -= 0.0005;
                
                renderer.render(scene, camera);
            }
            
            animate();
            
            // Handle window resize
            window.addEventListener('resize', () => {
                const newWidth = container.clientWidth;
                const newHeight = container.clientHeight;
                
                camera.aspect = newWidth / newHeight;
                camera.updateProjectionMatrix();
                
                renderer.setSize(newWidth, newHeight);
            });
        }
        
        // Initialize Earth when page loads
        window.addEventListener('load', initEarth);
        
        // Helper function to show notifications
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 8px;
                color: white;
                font-family: 'Tajawal', sans-serif;
                z-index: 10000;
                opacity: 0;
                transform: translateY(20px);
                transition: all 0.3s ease;
                max-width: 300px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            `;
            
            if (type === 'success') {
                notification.style.background = 'linear-gradient(135deg, #2ecc71, #27ae60)';
            } else if (type === 'error') {
                notification.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
            } else {
                notification.style.background = 'linear-gradient(135deg, #3498db, #2980b9)';
            }
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // Animate in
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateY(0)';
            }, 10);
            
            // Animate out and remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // Set today's date as default
        document.getElementById('date-selection').valueAsDate = new Date();
    </script>
</body>
</html>
